<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Numble - The Number Guessing Game</title>
    <link href="index.css" rel="stylesheet">
</head>
<body>
    <header>
        <header>
            <button class="burger-menu-button" aria-label="Toggle navigation" aria-expanded="false" aria-controls="navigation">
                <span class="burger-menu-icon"></span>
            </button>
            <div class="nav-elements">
                <nav>
                    <a class="nav-item" href="#">Help</a>
             </nav>
          </div>
          <div class="logo">
            <img id="logo-img" src="https://lyfeguard.com/storage/app/media/Numble.png" alt="Numble logo">
         </div>
    </header>
    <div id="scoreDisplay">Your Score: 0</div>
    <select id="difficulty">
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
    </select> 
    <div id="guessGrid">
        <div class="guessRow">
            <div class="guessCell"></div>
            <div class="guessCell"></div>
            <div class="guessCell"></div>
            <div class="guessCell"></div>
            <div class="guessCell"></div>
            <div class="guessCell"></div>
        </div>
    </div>
    <div id="digitButtons">
        <button class="digitButton" data-digit="0">0</button>
        <button class="digitButton" data-digit="1">1</button>
        <button class="digitButton" data-digit="2">2</button>
        <button class="digitButton" data-digit="3">3</button>
        <button class="digitButton" data-digit="4">4</button>
        <button class="digitButton" data-digit="5">5</button>
        <button class="digitButton" data-digit="6">6</button>
        <button class="digitButton" data-digit="7">7</button>
        <button class="digitButton" data-digit="8">8</button>
        <button class="digitButton" data-digit="9">9</button>
        <button id="backButton">Back</button>
    </div>    
    <button id="submitGuess">Guess</button>
    <div id="message"></div>



    <div>
        <button id="restartGame">Restart</button>
    </div>
    
    <div id="myModal" class="modal">
        <!-- Modal content -->
        <img id="pop-logo" src="https://lyfeguard.com/storage/app/media/Numble.png" alt="Numble logo">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Welcome to Numble!</h2>
      <h3>Here are some instructions to get you started:</h3>

        <p>Guess the 6-digit number.</p>
        <p>You have six tries to guess it right.</p>
        <p>After each guess, the colour of the tiles will change to show how close your guess was to the number.</p>
     
        <h3>Difficulty Levels</h3>
        <p>Easy: The target number has no repeating digits.</p>
        <p>Medium: The target number can have up to two repeating digits.</p>
        <p>Hard: The target number can have multiple repeating digits.</p>  
      <button id="closeModalButton">Let's Play!</button>
    </div>
    </div>

    <script>
      let targetNumber, attempts, currentGuess = [], currentRow = 0;
      const maxGuessLength = 6;
      const totalRows = 6;
      const guessGrid = document.getElementById('guessGrid');
      const submitGuess = document.getElementById('submitGuess');
      const restartGame = document.getElementById('restartGame');
      const difficultySelect = document.getElementById('difficulty');
      const scoreDisplay = document.getElementById('scoreDisplay');
      const digitButtons = document.querySelectorAll('.digitButton');
      
      function generateRandomNumber(difficulty) {
        let number = '';
        while (number.length < maxGuessLength) {
          let digit = Math.floor(Math.random() * 10).toString();
          if ((difficulty === 'easy' && number.includes(digit)) ||
              (difficulty === 'medium' && number.split(digit).length - 1 > 2)) {
            continue;
          }
          number += digit;
        }
        return number;
      }
      
      function startNewGame() {
        targetNumber = generateRandomNumber(difficultySelect.value);
        attempts = 0;
        currentRow = 0;
        currentGuess = [];
        guessGrid.innerHTML = ''; // Clear the grid
        for (let i = 0; i < totalRows * maxGuessLength; i++) {
          let cell = document.createElement('div');
          cell.classList.add('guessCell');
          guessGrid.appendChild(cell);
        }
        scoreDisplay.textContent = "Score: 0";
        resetDigitButtons(); // Reset the digit buttons at the start of the game
      }
      
      function resetDigitButtons() {
        digitButtons.forEach(button => {
          button.classList.remove('crossed-out');
          button.disabled = false;
        });
      }
      
      function crossOutAbsentDigits(absentDigits) {
        digitButtons.forEach(button => {
          if (absentDigits.has(button.textContent)) {
            button.classList.add('crossed-out');
            button.disabled = true; // Disable the button
          }
        });
      }
      
      function updateGridWithGuess() {
        const guessCells = guessGrid.querySelectorAll('.guessCell');
        guessCells.forEach((cell, index) => {
          const rowIndex = Math.floor(index / maxGuessLength);
          const cellIndex = index % maxGuessLength;
          if (rowIndex === currentRow) {
            cell.textContent = currentGuess[cellIndex] || '';
            cell.classList.remove('correct', 'present', 'absent');
          }
        });
      }
      
      function checkWinCondition(guess) {
  const guessCells = guessGrid.querySelectorAll('.guessCell');
  let score = 100 - (10 * attempts);
  let digitsPresentInTarget = new Set(targetNumber.split('')); // Digits in the target number

  guess.split('').forEach((digit, index) => {
    const cellIndex = currentRow * maxGuessLength + index;
    if (digit === targetNumber[index]) {
      guessCells[cellIndex].classList.add('correct');
      score += 5; // Bonus points for correct digit
    } else if (targetNumber.includes(digit)) {
      guessCells[cellIndex].classList.add('present');
    } else {
      guessCells[cellIndex].classList.add('absent');
    }
  });

  // After checking the guess, cross out digit buttons for digits that are not in the target number
  if (difficultySelect.value === 'easy') {
    digitButtons.forEach(button => {
      if (!digitsPresentInTarget.has(button.textContent)) {
        button.classList.add('crossed-out');
        button.disabled = true; // Optionally disable the button
      }
    });
  }

  if (guess === targetNumber) {
    alert("Congratulations! You guessed the number! Your score: " + score);
    startNewGame();
  } else if (currentRow === totalRows - 1) {
    alert("Game Over! The number was " + targetNumber);
    startNewGame();
  } else {
    currentRow++;
    currentGuess = [];
    updateGridWithGuess();
  }

  scoreDisplay.textContent = "Score: " + score;
}

      
      startNewGame();
      
      digitButtons.forEach(button => {
        button.setAttribute('data-digit', button.textContent); // Set data-digit attribute
        button.addEventListener('click', () => {
          if (currentGuess.length < maxGuessLength) {
            currentGuess.push(button.textContent);
            updateGridWithGuess();
          }
        });
      });
      
      document.getElementById('backButton').addEventListener('click', () => {
        if (currentGuess.length > 0) {
          currentGuess.pop();
          updateGridWithGuess();
        }
      });
      
      submitGuess.addEventListener('click', () => {
        if (currentGuess.length === maxGuessLength) {
          attempts++;
          checkWinCondition(currentGuess.join(''));
          currentGuess = [];
          updateGridWithGuess();
        } else {
          alert("Please enter all 6 digits before submitting.");
        }
      });
      
      restartGame.addEventListener('click', startNewGame);

document.addEventListener('DOMContentLoaded', function() {
    var modal = document.getElementById('myModal');
    if (!modal) {
        console.error('Modal element not found');
        return;
    }

    var span = document.getElementsByClassName("close")[0];
    if (!span) {
        console.error('Close button element not found');
        return;
    }

    var closeModalButton = document.getElementById('closeModalButton'); // Get the new button

    // Open the modal
    modal.style.display = "block";

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
        modal.style.display = "none";
    }

     // When the user clicks on the new button, close the modal
     closeModalButton.onclick = function() {
        modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        var burger = document.querySelector('.burger-menu-button');
        var menu = document.querySelector('.nav-elements');
      
        burger.addEventListener('click', function() {
            menu.classList.toggle('is-active');
        });
      });
      
      burger.addEventListener('click', function() {
        var isExpanded = this.getAttribute('aria-expanded') === 'true' || false;
        this.setAttribute('aria-expanded', !isExpanded);
        menu.classList.toggle('is-active');
      });
});


</script>


</body>
</html>
